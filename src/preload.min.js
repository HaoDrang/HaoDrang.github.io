/*! HaoDrang.github.io-0.0.1.js 2016-04-26 */
function Preload(){this._progressBar=void 0,this._stage=void 0,this._loader=void 0}function PreloadProgressBar(a,b,c,d,e,f,g,h,i,j,k){this.posX=a,this.poxY=b,this.w=c,this.h=d,this.radius=e,this.offsetx=f,this.offsety=g,this.color=createjs.Graphics.getRGB(h,i,j,k),this.strokecolor=createjs.Graphics.getRGB(0,0,0,1),this.bgcolor=createjs.Graphics.getRGB(200,200,200,1),this.innerX=this.posX+this.offsetx,this.innerY=this.poxY+this.offsety,this.innerW=this.w-2*this.offsetx,this.innerH=this.h-2*this.offsety}function resizeCanvas(a){var b=a.canvas,c=0,d=0,e=CANVAS_W,f=CANVAS_H;c=jQuery(window).width(),d=jQuery(window).height();var g=1;e/f>c/d?(g=c/e,b.width=c,b.height=g*f):(g=d/f,b.height=d,b.width=g*e),rescaleStage(a,g),window.scrollTo(0,1)}function rescaleStage(a,b){a.scaleX=a.scaleY=b,a.update()}function toggleFullScreen(a){void 0!==document.fullScreenElement&&null===document.fullScreenElement||void 0!==document.msFullscreenElement&&null===document.msFullscreenElement||void 0!==document.mozFullScreen&&!document.mozFullScreen||void 0!==document.webkitIsFullScreen&&!document.webkitIsFullScreen?a.requestFullScreen?a.requestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen?a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):a.msRequestFullscreen&&a.msRequestFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}var CANVAS_W=540,CANVAS_H=960,MANIFEST_JSON="loadmanifest/imgmanifest.json";Preload.prototype=new createjs.Container,Preload.prototype.container_initialize=Preload.prototype.initialize,Preload.prototype.initialize=function(){this.container_initialize();var a=document.getElementById("gameCanvas");CANVAS_W=a.width,CANVAS_H=a.height,console.log("game canvas created...");var b=new createjs.Stage(a);this._stage=b,console.log("stage is ready..."),this.buildUI(b),resizeCanvas(b),jQuery(window).resize(function(){resizeCanvas(b),console.log("width :"+b.canvas.width+" , height : "+b.canvas.height)}),this._loader=this.initLoader(this._progressBar)},Preload.prototype.buildUI=function(a){var b=CANVAS_W-40,c=30,d=(CANVAS_W-b)/2,e=(CANVAS_H-c)/2;this._progressBar=new PreloadProgressBar(d,e,b,c,5,2,2,80,200,80,1),this._progressBar.scaleX=this._progressBar.scaleY=a.scaleX,a.addChild(this._progressBar),this._progressBar.updateProgress(5,100),a.update(),console.log("x "+this._progressBar.x+" y:"+this._progressBar.y),console.log("stage "+a.canvas.width+"  "+a.canvas.height)},Preload.prototype.initLoader=function(a){var b=new createjs.LoadQueue(!1);return b.on("fileload",this.handleFileLoad,this),b.on("complete",this.handleComplete,this),b.on("progress",this.handleProgress,this),b.on("error",this.handleError,this),b.loadManifest(MANIFEST_JSON),b},Preload.prototype.handleFileLoad=function(a){},Preload.prototype.handleComplete=function(a){console.log("load complete~"),this._progressBar.visible=!1,this._stage.clear();var b=new common.Service(this._stage,this._loader),c=new Game(this._stage,b);c.Start()},Preload.prototype.handleProgress=function(a){this._progressBar.updateProgress(1e3*a.progress,1e3),this._stage.update()},Preload.prototype.handleError=function(a){console.log("[ERROR] "+a)},PreloadProgressBar.prototype=new createjs.Shape,PreloadProgressBar.prototype.updateProgress=function(a,b){this.graphics.clear(),this.graphics.beginFill(this.strokecolor).drawRoundRect(this.posX,this.poxY,this.w,this.h,this.radius,this.radius,this.radius,this.radius),this.graphics.beginFill(this.bgcolor).drawRoundRect(this.innerX,this.innerY,this.innerW,this.innerH,this.radius,this.radius,this.radius,this.radius),this.graphics.beginFill(this.color).drawRoundRect(this.innerX,this.innerY,this.innerW*a/b,this.innerH,this.radius,this.radius,this.radius,this.radius),this.graphics.endFill()};